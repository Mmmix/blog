<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<link href="../css/signin.css" rel="stylesheet" type="text/css" media="all" />
		<link href="../layui/css/layui.css" rel="stylesheet" />
		<script type="text/javascript" src="../js/vue.js"></script>
		<script src="../js/vue-resource.min.js"></script>
	</head>

	<body>

		<div id="app">
			{{message}}
			<form class="layui-form form-signin">
				<div class="layui-form-item">
					<div class="layui-input-inline">
						<span class="layui-icon input-icon">&#xe66f;</span>
						<input type="text" v-model="username" lay-verify="title" autocomplete="off" placeholder="请输入用户名" class="layui-input">
					</div>
				</div>
				<div class="layui-form-item">
					<div class="layui-input-inline">
						<span class="layui-icon input-icon">&#xe673</span>
						<input type="password" v-model="password" lay-verify="required" placeholder="请输入密码" autocomplete="off" class="layui-input">
					</div>
				</div>
				<div class="checkbox layui-col-lg-offset3">
					<label>
                <input type="checkbox" value="remember-me"> Remember me
            </label>
				</div>
				<button class="layui-btn layui-btn-no" type="button" @click="login()">Sign in</button>
			</form>

		</div>

		<script type="text/javascript" src="../layui/layui.js"></script>
		<script>
			var localhost = "http://localhost:8080";
			var app = new Vue({
				el: '#app',
				data: {
					username: "",
					password: "",
					message: 'Hello Vue.js!'
				},
				methods: {
					login: function() {
						var _this = this;
						console.log(this.password);
						Vue.http.post(localhost + "/login", {
							'username': _this.username,
							'password': _this.password
						}, {
							emulateJSON: true
						}).then(function(res) {
							if(res.body.code==-1){
								_this.message = res.body.msg;
							}else{
//								console.log(res);
								sessionStorage.setItem("token",res.body.data.token);
								window.location.href="blogManagement.html";
							}
						}, function(res) {
							console.log(res.status);
						});
					}
				}
			})
			layui.config({
				base: '../js/util/'
			}).use(['element', 'laypage', 'jquery', 'menu'], function() {
				element = layui.element, laypage = layui.laypage, $ = layui.$, menu = layui.menu;

				menu.init();
			})
		</script>

	</body>

</html>